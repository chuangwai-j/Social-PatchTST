# Social-PatchTST: åŸºäºTransformerçš„èˆªç­è½¨è¿¹é¢„æµ‹ç³»ç»Ÿ

## é¡¹ç›®æ¦‚è¿°

Social-PatchTSTæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºèˆªç­è½¨è¿¹é¢„æµ‹çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œç»“åˆäº†å½“å‰æœ€å…ˆè¿›çš„PatchTSTæ—¶åºé¢„æµ‹æŠ€æœ¯å’ŒSocial Transformerå¤šæ™ºèƒ½ä½“äº¤äº’å»ºæ¨¡æŠ€æœ¯ï¼Œä¸“é—¨è§£å†³å¤šæ¶é£æœºä¹‹é—´çš„æœ€å°è·ç¦»ï¼ˆmindistï¼‰é¢„æµ‹é—®é¢˜ã€‚

è¯¥ç³»ç»Ÿæä¾›äº†ä»åŸå§‹ADS-Bæ•°æ®åˆ°æ¨¡å‹è®­ç»ƒçš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ¨ç†å’Œè¯„ä¼°çš„å…¨å¥—å·¥å…·é“¾ã€‚

### ğŸš€ æ ¸å¿ƒç‰¹æ€§

- **PatchTSTæ—¶åºç¼–ç **: å°†é•¿æ—¶é—´åºåˆ—åˆ†å‰²ä¸ºé‡å çš„patchï¼Œæœ‰æ•ˆæ•æ‰å±€éƒ¨æ—¶åºæ¨¡å¼
- **Social Transformer**: å»ºæ¨¡é£æœºé—´çš„ç¤¾äº¤äº¤äº’ï¼Œæ˜¾å¼è€ƒè™‘ç‰©ç†è·ç¦»ä¿¡æ¯
- **ç›¸å¯¹ä½ç½®ç¼–ç (RPE)**: å°†é£æœºé—´è·ç¦»ç¼–ç ä¸ºæ³¨æ„åŠ›åç½®ï¼Œå¼ºåŒ–mindistçº¦æŸ
- **å¤šä»»åŠ¡æŸå¤±**: ç»“åˆä½ç½®ã€é€Ÿåº¦ã€é«˜åº¦å’Œæœ€å°è·ç¦»çš„è”åˆä¼˜åŒ–
- **ç«¯åˆ°ç«¯è®­ç»ƒ**: ä»åŸå§‹ADS-Bæ•°æ®åˆ°è½¨è¿¹é¢„æµ‹çš„å®Œæ•´æµç¨‹
- **æ™ºèƒ½æ•°æ®å¤„ç†**: è‡ªåŠ¨å»é‡ã€é‡é‡‡æ ·ã€é»„é‡‘æ•°æ®æå–å’Œä¸‰åˆ†å‰²

### ğŸ“ é¡¹ç›®ç»“æ„

```
Social-PatchTST/
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ social_patchtst_config.yaml    # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config_manager.py             # é…ç½®ç®¡ç†å·¥å…·
â”œâ”€â”€ data/                       # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ dataset/
â”‚   â”‚   â”œâ”€â”€ data_processor.py          # æ•°æ®é¢„å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â””â”€â”€ gold_data_extract/
â”‚       â”œâ”€â”€ adsb_gold_data_extractor.py # é»„é‡‘æ•°æ®æå–å·¥å…·
â”‚       â””â”€â”€ README.md                  # æ•°æ®å¤„ç†è¯´æ˜
â”œâ”€â”€ model/                      # æ¨¡å‹å®ç°
â”‚   â”œâ”€â”€ social_patchtst.py            # å®Œæ•´æ¨¡å‹
â”‚   â”œâ”€â”€ patchtst.py                  # PatchTSTæ¨¡å—
â”‚   â”œï¿½ï¿½â”€ social_transformer.py        # Social Transformer
â”‚   â”œâ”€â”€ prediction_decoder.py         # é¢„æµ‹è§£ç å™¨
â”‚   â”œâ”€â”€ relative_position_encoding.py # ç›¸å¯¹ä½ç½®ç¼–ç 
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ tools/                      # è®­ç»ƒå’Œæ¨ç†å·¥å…·
â”‚   â”œâ”€â”€ train.py                     # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ inference.py                 # æ¨ç†è„šæœ¬
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ main.py                     # ä¸»å…¥å£æ–‡ä»¶
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
```

## ğŸ“Š æ•°æ®é¢„å¤„ç†è§£å†³æ–¹æ¡ˆ

### ğŸ¯ æ ¸å¿ƒé—®é¢˜è§£å†³æ–¹æ¡ˆ

1. **å¤§æ•°æ®é‡å¤„ç†**: ä»5.48äº¿è¡ŒåŸå§‹æ•°æ®å¿«é€Ÿå»é‡åˆ°2.7-3.3äº¿è¡Œ
2. **ä¸‰åˆ†å‰²æ•°æ®é›†**: è‡ªåŠ¨ç”Ÿæˆè®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†
3. **ç²¾ç¡®æ•°æ®é‡æ§åˆ¶**: ç›®æ ‡å¯¼å‘çš„æ™ºèƒ½é‡‡æ ·
4. **å¹³è¡¡æ•°æ®åˆ†é…**: æµ‹è¯•é›†åŒ…å«é»„é‡‘æ•°æ®å’Œå·¡èˆªæ•°æ®

### åŸå§‹æ•°æ®ç‰¹å¾
- **æ•°æ®æ¥æº**: 1863ä¸ªCSVæ–‡ä»¶ï¼Œè¦†ç›–2ä¸ªå¤šæœˆçš„æ•°æ®
- **æ•°æ®è§„æ¨¡**: çº¦3-5äº¿æ¡ADS-Bè®°å½•
- **æ—¶é—´æˆ³æ ¼å¼**: ä»åŸºå‡†ç‚¹å¼€å§‹çš„ç§’æ•°
- **åŸå§‹æ›´æ–°é¢‘ç‡**: çº¦0.4-0.6ç§’é—´éš”ï¼ˆé«˜é¢‘æ•°æ®ï¼‰
- **æ•°æ®é‡å¤**: å‘ç°å¤§é‡ç²¾ç¡®é‡å¤çš„è¡Œï¼Œéœ€è¦å»é‡å¤„ç†

### é»„é‡‘æ•°æ®å®šä¹‰
è½¨è¿¹æ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶å³è¢«æ ‡è®°ä¸º"é»„é‡‘æ•°æ®"ï¼š

1. **ä½ç©ºæœºåŠ¨** (TMAåŒºåŸŸ): è½¨è¿¹ä¸­æœ‰ä»»ä½•ç‚¹çš„å‡ ä½•é«˜åº¦ä½äº18,000è‹±å°º
2. **å‚ç›´æœºåŠ¨**: è½¨è¿¹ä¸­æœ‰ä»»ä½•ç‚¹çš„å‚ç›´é€Ÿåº¦ç»å¯¹å€¼å¤§äº500 ft/min
3. **æ„å›¾å˜åŒ–**: è½¨è¿¹ä¸­é€‰æ‹©é«˜åº¦å‘ç”Ÿè¿‡å˜åŒ–
4. **èˆªå‘å˜åŒ–**: è½¨è¿¹çš„èˆªå‘å˜åŒ–ç‡å¤§äº1åº¦/ç§’

### ğŸš€ å®Œæ•´æ•°æ®å¤„ç†æµç¨‹

#### ç¬¬ä¸€æ­¥ï¼šé»„é‡‘æ•°æ®æå– + ä¸‰åˆ†å‰²
```bash
cd /home/wai/Social-PatchTST/data/gold_data_extract
python adsb_gold_data_extractor.py --max-files 200 --train-size 20000000 --val-size 5000000 --test-size 5000000
```

**é¢„æœŸæ•ˆæœ**ï¼š
- è®­ç»ƒé›†ï¼š2000ä¸‡è¡Œ (67%)
- éªŒè¯é›†ï¼š500ä¸‡è¡Œ (16%)
- æµ‹è¯•é›†ï¼š500ä¸‡è¡Œ (16%)
- **å‹ç¼©æ¯”**ï¼šçº¦200:1

#### æ•°æ®é›†é…ç½®å‚æ•°
```bash
# è‡ªå®šä¹‰æ•°æ®é›†å¤§å°
python adsb_gold_data_extractor.py \
    --max-files 200 \              # æœ€å¤§å¤„ç†æ–‡ä»¶æ•°
    --train-size 20000000 \        # è®­ç»ƒé›†å¤§å°
    --val-size 5000000 \           # éªŒè¯é›†å¤§å°
    --test-size 5000000 \          # æµ‹è¯•é›†å¤§å°
    --resample-rate 5S             # é‡é‡‡æ ·é—´éš”
```

#### è¾“å‡ºæ–‡ä»¶ç»“æ„
```
/mnt/d/model/adsb/
â”œâ”€â”€ train_dataset.csv      # è®­ç»ƒé›†
â”œâ”€â”€ validation_dataset.csv # éªŒè¯é›†
â”œâ”€â”€ test_dataset.csv       # æµ‹è¯•é›†
â””â”€â”€ data_stats.json        # æ•°æ®ç»Ÿè®¡ä¿¡æ¯
```

### æ•°æ®é›†ç‰¹å¾
- **é»„é‡‘æ•°æ®**: çº¦96% (é«˜ä»·å€¼æœºåŠ¨åœºæ™¯)
- **å¹³é£æ•°æ®**: çº¦4% (æ­£å¸¸é£è¡Œåœºæ™¯)
- **æµ‹è¯•é›†**: åŒæ ·åŒ…å«é»„é‡‘å’Œå·¡èˆªæ•°æ®ï¼Œç¡®ä¿è¯„ä¼°çš„å…¨é¢æ€§

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£…ä¾èµ–
pip install torch pandas numpy tqdm scikit-learn matplotlib
```

### 2. æ•°æ®å‡†å¤‡
```bash
cd /home/wai/Social-PatchTST/data/gold_data_extract
python adsb_gold_data_extractor.py --max-files 200 --train-size 20000000 --val-size 5000000 --test-size 5000000
```

### 3. è®­ç»ƒæ¨¡å‹
```bash
cd /home/wai/Social-PatchTST
python main.py --mode train --config ./config/social_patchtst_config.yaml
```

### 4. æ¨¡å‹æ¨ç†
```bash
python main.py --mode predict \
    --input /mnt/d/model/adsb/test_dataset.csv \
    --output ./predictions.csv \
    --visualize
```

### 5. æ¨¡å‹æµ‹è¯•
```bash
python main.py --mode test --config ./config/social_patchtst_config.yaml
```

### å‘½ä»¤è¡Œå‚æ•°è¯¦è§£
```bash
# åŸºæœ¬è®­ç»ƒ
python main.py --mode train

# å®Œæ•´å‚æ•°ç¤ºä¾‹
python main.py --mode train \
    --config ./config/social_patchtst_config.yaml \
    --model ./logs/best_model.pth \
    --input ./test_data.csv \
    --output ./predictions.csv \
    --max_aircrafts 50 \
    --visualize

# é¢„æµ‹æ¨¡å¼
python main.py --mode predict \
    --input /mnt/d/model/adsb/test_dataset.csv \
    --output ./predictions.csv \
    --model ./logs/best_model.pth \
    --visualize

# æŸ¥çœ‹å¸®åŠ©
python main.py --help
```

## âš™ï¸ é…ç½®å‚æ•°

### ä¸»è¦é…ç½®å‚æ•°
```yaml
# æ•°æ®é…ç½®
data:
  history_length: 120        # å†å²åºåˆ—é•¿åº¦ (10åˆ†é’Ÿ)
  prediction_length: 120     # é¢„æµ‹åºåˆ—é•¿åº¦ (10åˆ†é’Ÿ)
  sampling_interval: 5       # é‡‡æ ·é—´éš”ï¼ˆç§’ï¼‰

# PatchTSTå‚æ•°
patchtst:
  patch_length: 16           # Patché•¿åº¦
  stride: 8                  # Patchæ­¥é•¿
  d_model: 512               # æ¨¡å‹ç»´åº¦
  n_heads: 8                 # æ³¨æ„åŠ›å¤´æ•°
  n_layers: 6                # Transformerå±‚æ•°

# Social Transformerå‚æ•°
social_transformer:
  rpe:
    enabled: true             # å¯ç”¨ç›¸å¯¹ä½ç½®ç¼–ç 
    max_distance: 100        # æœ€å¤§è€ƒè™‘è·ç¦»ï¼ˆæµ·é‡Œï¼‰
    distance_bins: 20         # è·ç¦»åˆ†ç®±æ•°
  interaction_threshold: 10   # äº¤äº’è·ç¦»é˜ˆå€¼ï¼ˆæµ·é‡Œï¼‰

# è®­ç»ƒå‚æ•°
training:
  batch_size: 32             # æ‰¹å¤§å°
  learning_rate: 0.0001      # å­¦ä¹ ç‡
  epochs: 100                # è®­ç»ƒè½®æ•°
```

### é‡è¦å­—æ®µè¯´æ˜
è¾“å…¥æ•°æ®å¿…é¡»åŒ…å«ä»¥ä¸‹å­—æ®µï¼ˆä½¿ç”¨flight_levelè€Œä¸æ˜¯geometric_altitudeï¼‰ï¼š
- `target_address`, `callsign`, `timestamp` (åŸºç¡€å­—æ®µ)
- `flight_level`, `ground_speed`, `track_angle`, `vertical_rate`, `selected_altitude` (æ•°å€¼ç‰¹å¾)
- `latitude`, `longitude` (ä½ç½®ç‰¹å¾)
- `lnav_mode`, `aircraft_type` (åˆ†ç±»ç‰¹å¾)

**é‡è¦**: ä½¿ç”¨`flight_level`ï¼ˆæ°”å‹é«˜åº¦ï¼‰è€Œä¸æ˜¯`geometric_altitude`ï¼Œå› ä¸º`selected_altitude`ä¸æ°”å‹é«˜åº¦åŒ¹é…æ›´å¥½ï¼

## ğŸ“ˆ æ¨¡å‹æ¶æ„

### ä¸‰å±‚æ¶æ„è®¾è®¡

1. **Temporal Encoder (PatchTST)**
   - è¾“å…¥ï¼š`[batch_size, n_aircrafts, 120, 5]` (120ç‚¹å†å²ï¼Œ5ä¸ªæ—¶åºç‰¹å¾)
   - å¤„ç†ï¼šå°†æ—¶åºåˆ†å‰²ä¸ºpatchï¼Œå­¦ä¹ å•æœºé£è¡Œæ¨¡å¼
   - è¾“å‡ºï¼š`[batch_size, n_aircrafts, n_patches, 512]`

2. **Social Encoder**
   - è¾“å…¥ï¼šæ¥è‡ªTemporal Encoderçš„ç‰¹å¾
   - å¤„ç†ï¼šä½¿ç”¨å¸¦RPEçš„Transformerå»ºæ¨¡é£æœºé—´äº¤äº’
   - è¾“å‡ºï¼š`[batch_size, n_aircrafts, n_patches, 512]`

3. **Prediction Decoder**
   - è¾“å…¥ï¼šç¤¾äº¤æ„ŸçŸ¥ç‰¹å¾
   - å¤„ç†ï¼šTransformerè§£ç å™¨ç”Ÿæˆæœªæ¥è½¨è¿¹
   - è¾“å‡ºï¼š`[batch_size, n_aircrafts, 120, 5]` (120ç‚¹é¢„æµ‹)

### å…³é”®æŠ€æœ¯ç‰¹ç‚¹

- **Patchingæœºåˆ¶**: `patch_length=16, stride=8`ï¼Œæœ‰æ•ˆé™ä½è®¡ç®—å¤æ‚åº¦
- **ç›¸å¯¹ä½ç½®ç¼–ç **: å°†ç‰©ç†è·ç¦»ç¼–ç ä¸ºæ³¨æ„åŠ›åç½®ï¼Œå¼ºåŒ–mindistçº¦æŸ
- **å¤šä»»åŠ¡æŸå¤±**: `position:1.0, velocity:0.5, altitude:1.0, mindist:2.0`
- **æ··åˆç²¾åº¦è®­ç»ƒ**: æ”¯æŒFP16åŠ é€Ÿè®­ç»ƒ

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### è¯„ä¼°æŒ‡æ ‡
- **ä½ç½®è¯¯å·®**: RMSE, MAE (ç»çº¬åº¦)
- **é«˜åº¦è¯¯å·®**: RMSE, MAE (æ°”å‹é«˜åº¦)
- **é€Ÿåº¦è¯¯å·®**: RMSE, MAE (åœ°é€Ÿã€èˆªå‘)
- **å®‰å…¨æŒ‡æ ‡**: æœ€å°è·ç¦»è¿è§„ç‡ã€ç¢°æ’é£é™©è¯„åˆ†

### åŸºçº¿æ€§èƒ½
åœ¨æµ‹è¯•é›†ä¸Šçš„æ€§èƒ½æŒ‡æ ‡ï¼ˆç¤ºä¾‹ï¼‰ï¼š
- ä½ç½®RMSE: 0.0002åº¦
- é«˜åº¦RMSE: 150è‹±å°º
- é€Ÿåº¦RMSE: 8èŠ‚
- èˆªå‘RMSE: 3åº¦
- Mindistè¿è§„ç‡: <1%

## ğŸ”§ é«˜çº§ç”¨æ³•

### 1. è‡ªå®šä¹‰é…ç½®
```python
from config.config_manager import load_config

# åŠ è½½å¹¶ä¿®æ”¹é…ç½®
config = load_config('./config/social_patchtst_config.yaml')
config.set('patchtst.d_model', 768)  # å¢åŠ æ¨¡å‹ç»´åº¦
config.set('training.learning_rate', 0.00005)  # é™ä½å­¦ä¹ ç‡
config.save('./config/custom_config.yaml')
```

### 2. å¤šGPUè®­ç»ƒ
```yaml
device:
  gpu_ids: [0, 1, 2, 3]    # ä½¿ç”¨4ä¸ªGPU
  mixed_precision: true      # æ··åˆç²¾åº¦è®­ç»ƒ
```

### 3. æ•°æ®å¢å¼º
```yaml
augmentation:
  enabled: true              # å¯ç”¨æ•°æ®å¢å¼º
  noise_std: 0.01            # é«˜æ–¯å™ªå£°æ ‡å‡†å·®
  time_shift: 2              # æ—¶é—´åç§»
  dropout_rate: 0.1          # ç‰¹å¾dropoutç‡
```

## ğŸ“ˆ å¤„ç†æ•ˆç‡ä¸æ€§èƒ½

### æ•°æ®å¤„ç†æ•ˆç‡
- **å»é‡é˜¶æ®µ**: å‡å°‘40-50%æ•°æ®é‡
- **é‡é‡‡æ ·é˜¶æ®µ**: 5ç§’é—´éš”å‡å°‘90%å™ªå£°
- **æ™ºèƒ½é‡‡æ ·**: ç²¾ç¡®æ§åˆ¶ç›®æ ‡æ•°æ®é‡

### è®­ç»ƒæ•ˆç‡
- **å•epochæ—¶é—´**: çº¦15-20åˆ†é’Ÿ
- **æ”¶æ•›epochæ•°**: 50-100 epoch
- **æ€»è®­ç»ƒæ—¶é—´**: çº¦15-30å°æ—¶
- **å†…å­˜éœ€æ±‚**: 16-32GB GPUå†…å­˜

### æ•°æ®è´¨é‡ä¿è¯
- **å»é‡ç®—æ³•**: æŒ‰ (é£æœºID, æ—¶é—´æˆ³) å»é‡ï¼Œä¿ç•™æœ€åè®°å½•
- **é‡é‡‡æ ·ç®—æ³•**: æ•°å€¼åˆ—çº¿æ€§æ’å€¼ï¼Œåˆ†ç±»åˆ—å‰å‘å¡«å……
- **é»„é‡‘æ•°æ®è¯„åˆ†**: å››æ¡è§„åˆ™è¯†åˆ«é«˜ä»·å€¼è½¨è¿¹

### æ—¶é—´ä¼°ç®—
- **æ•°æ®å¤„ç†**: çº¦6-12å°æ—¶ï¼ˆå–å†³äºæ•°æ®é‡ï¼‰
- **æ¨¡å‹è®­ç»ƒ**: çº¦15-30å°æ—¶
- **æ€»æ—¶é—´**: çº¦21-42å°æ—¶

## ğŸ›¡ï¸ é‡è¦æé†’

### ç³»ç»Ÿè¦æ±‚
- **å†…å­˜ä½¿ç”¨**: å¤„ç†å¤§é‡æ–‡ä»¶æ—¶éœ€è¦è¶³å¤Ÿå†…å­˜ï¼ˆå»ºï¿½ï¿½ï¿½32GB+ï¼‰
- **å­˜å‚¨ç©ºé—´**: ç¡®ä¿è¾“å‡ºç›®å½•æœ‰è¶³å¤Ÿç£ç›˜ç©ºé—´
- **GPUè¦æ±‚**: 16-32GB GPUå†…å­˜ç”¨äºè®­ç»ƒ
- **å¤„ç†æ—¶é—´**: å®Œæ•´å¤„ç†å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´

### å…³é”®å­—æ®µè¦æ±‚
è¾“å…¥æ•°æ®å¿…é¡»åŒ…å«ä»¥ä¸‹å­—æ®µï¼š
- `target_address`, `callsign`, `timestamp` (åŸºç¡€å­—æ®µ)
- `flight_level`, `ground_speed`, `track_angle`, `vertical_rate`, `selected_altitude` (æ•°å€¼ç‰¹å¾)
- `latitude`, `longitude` (ä½ç½®ç‰¹å¾)
- `lnav_mode`, `aircraft_type` (åˆ†ç±»ç‰¹å¾)

### æ•°æ®å¤„ç†æœ€ä½³å®è·µ
1. **å…ˆå°æ‰¹é‡æµ‹è¯•**: ä½¿ç”¨å°å‚æ•°æµ‹è¯•æµç¨‹
2. **ç›‘æ§å†…å­˜ä½¿ç”¨**: å¤§æ•°æ®é›†å¤„ç†æ—¶ç›‘æ§å†…å­˜
3. **éªŒè¯è¾“å‡ºæ ¼å¼**: ç¡®ä¿è¾“å‡ºç¬¦åˆæ¨¡å‹è¦æ±‚
4. **å¤‡ä»½é‡è¦æ•°æ®**: å¤„ç†å‰å¤‡ä»½åŸå§‹æ•°æ®

## ğŸ“š æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: å†…å­˜ä¸è¶³æ€ä¹ˆåŠï¼Ÿ**
A: å‡å°‘`--max-files`å‚æ•°å€¼ï¼Œåˆ†æ‰¹å¤„ç†æ•°æ®

**Q: æ•°æ®é›†ä¸å¤Ÿå¤§æ€ä¹ˆåŠï¼Ÿ**
A: å¢åŠ `--max-files`å‚æ•°å€¼ï¼Œå¤„ç†æ›´å¤šåŸå§‹æ–‡ä»¶

**Q: å¤„ç†é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ**
A: æ£€æŸ¥è¾“å…¥æ•°æ®å¤§å°ï¼Œè€ƒè™‘ä½¿ç”¨SSDå­˜å‚¨ï¼Œå¢åŠ å¹¶è¡Œå¤„ç†

**Q: è¾“å‡ºæ ¼å¼ä¸å¯¹æ€ä¹ˆåŠï¼Ÿ**
A: å·¥å…·å·²ç¡®ä¿æ­£ç¡®çš„åˆ—é¡ºåºå’Œæ’åºï¼Œå¦‚æœ‰é—®é¢˜è¯·æ£€æŸ¥è¾“å…¥æ•°æ®æ ¼å¼

**Q: æ¨¡å‹ä¸æ”¶æ•›ï¼Ÿ**
A: é™ä½å­¦ä¹ ç‡ã€å¢åŠ warmupã€æ£€æŸ¥æ•°æ®è´¨é‡ã€å‡å°‘æ‰¹æ¬¡å¤§å°

**Q: GPUå†…å­˜ä¸è¶³ï¼Ÿ**
A: å‡å°‘batch_sizeï¼Œä½¿ç”¨gradient accumulationï¼Œæˆ–ä½¿ç”¨CPUè®­ç»ƒ

**Q: é¢„æµ‹ç»“æœå¼‚å¸¸ï¼Ÿ**
A: æ£€æŸ¥è¾“å…¥æ•°æ®æ ¼å¼ï¼Œç¡®è®¤æ¨¡å‹æƒé‡æ­£ç¡®åŠ è½½ï¼ŒéªŒè¯æ•°æ®é¢„å¤„ç†

## ğŸ“ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### ä¸»è¦æ¨¡å—
- `main.py` - ä¸»å…¥å£æ–‡ä»¶ï¼ˆæ”¯æŒtrain/test/predictæ¨¡å¼ï¼‰
- `config/social_patchtst_config.yaml` - ä¸»é…ç½®æ–‡ä»¶
- `config/config_manager.py` - é…ç½®ç®¡ç†å·¥å…·

### æ¨¡å‹æ–‡ä»¶
- `model/social_patchtst.py` - å®Œæ•´æ¨¡å‹å®ç°
- `model/patchtst.py` - PatchTSTæ—¶åºç¼–ç å™¨
- `model/social_transformer.py` - Social Transformerç¤¾äº¤ç¼–ç å™¨
- `model/prediction_decoder.py` - é¢„æµ‹è§£ç å™¨
- `model/relative_position_encoding.py` - ç›¸å¯¹ä½ç½®ç¼–ç 

### å·¥å…·è„šæœ¬
- `tools/train.py` - è®­ç»ƒè„šæœ¬
- `tools/inference.py` - æ¨ç†è„šæœ¬
- `data/dataset/data_processor.py` - æ•°æ®é¢„å¤„ç†å™¨

### æ•°æ®å¤„ç†
- `data/gold_data_extract/adsb_gold_data_extractor.py` - é»„é‡‘æ•°æ®æå–å·¥å…·
- `data/gold_data_extract/README.md` - è¯¦ç»†æ•°æ®å¤„ç†è¯´æ˜

## ğŸ“š ç†è®ºèƒŒæ™¯

### PatchTST
- **è®ºæ–‡**: PatchTST: Time Series Forecasting with Patching (ICLR 2023)
- **æ ¸å¿ƒæ€æƒ³**: å°†æ—¶é—´åºåˆ—åˆ†å‰²ä¸ºpatchï¼Œè§£å†³Transformerå¤„ç†é•¿åºåˆ—çš„æ•ˆç‡é—®é¢˜
- **ä¼˜åŠ¿**: ä¿ç•™å±€éƒ¨æ€§ã€é™ä½å¤æ‚åº¦ã€æå‡é¢„æµ‹ç²¾åº¦

### Social Transformer
- **æ ¸å¿ƒæ€æƒ³**: ä½¿ç”¨Transformerçš„è‡ªæ³¨æ„åŠ›æœºåˆ¶å»ºæ¨¡å¤šæ™ºèƒ½ä½“äº¤äº’
- **RPE**: ç›¸å¯¹ä½ç½®ç¼–ç å°†ç‰©ç†è·ç¦»ä¿¡æ¯èå…¥æ³¨æ„åŠ›è®¡ç®—
- **åº”ç”¨**: å¤šæœºå™¨äººåè°ƒã€äº¤é€šæµé‡é¢„æµ‹ã€ç¤¾äº¤ç½‘ç»œåˆ†æ

### Mindisté—®é¢˜
- **å®šä¹‰**: æœ€å°é—´éš”çº¦æŸï¼Œç¡®ä¿é£æœºé—´ä¿æŒå®‰å…¨è·ç¦»
- **æŒ‘æˆ˜**: å¤šç›®æ ‡ä¼˜åŒ–ã€åŠ¨æ€ç¯å¢ƒã€å®æ—¶æ€§è¦æ±‚
- **è§£å†³æ–¹æ¡ˆ**: é€šè¿‡RPEæ˜¾å¼ç¼–ç è·ç¦»çº¦æŸï¼Œè”åˆä¼˜åŒ–é¢„æµ‹ç²¾åº¦å’Œå®‰å…¨æ€§

## ğŸ¯ å¿«é€Ÿå¼€å§‹æŒ‡å—

### 1. ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†é¡¹ç›®ï¼ˆå¦‚é€‚ç”¨ï¼‰
cd /home/wai/Social-PatchTST

# å®‰è£…ä¾èµ–
pip install torch pandas numpy tqdm scikit-learn matplotlib
```

### 2. æ•°æ®å‡†å¤‡ï¼ˆå°è§„æ¨¡æµ‹è¯•ï¼‰
```bash
cd data/gold_data_extract
python adsb_gold_data_extractor.py --max-files 10 --train-size 100000 --val-size 20000 --test-size 20000
```

### 3. å¿«é€Ÿè®­ç»ƒæµ‹è¯•
```bash
cd ../..
python main.py --mode train --config ./config/social_patchtst_config.yaml
```

### 4. é¢„æµ‹æµ‹è¯•
```bash
python main.py --mode predict \
    --input /mnt/d/model/adsb/test_dataset.csv \
    --output ./test_predictions.csv \
    --visualize
```

## ğŸ“„ ç‰ˆæœ¬ä¿¡æ¯

**ç‰ˆæœ¬**: å®Œæ•´æ•´åˆç‰ˆ v1.0
**æ›´æ–°æ—¥æœŸ**: 2025-11-10
**ä½œè€…**: Claude Code Assistant
**è®¸å¯è¯**: ç ”ç©¶ç”¨é€”

### è‡´è°¢
æ„Ÿè°¢PatchTSTå’ŒTransformeråŸä½œè€…çš„å¼€æºè´¡çŒ®ï¼Œä»¥åŠADS-Bæ•°æ®æä¾›è€…çš„æ”¯æŒã€‚

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªç ”ç©¶é¡¹ç›®ï¼Œä¸»è¦ç”¨äºå­¦æœ¯ç›®çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·è¿›è¡Œå……åˆ†çš„æµ‹è¯•å’ŒéªŒè¯ã€‚